Limitations (in addition to below tasks):
    - Only try to send 1 train through a tunnel at once. It won't stop more, but will error if they can't come out smoothly.
    - Currently limited to 500 tiles of tunnel and train each side from middle of tunnel - can run a 4-16-4 through a sensible tunnel fine.
    - Trains must be lead by a locomotive facing forwards, otherwise they will get stuck and error coming out of a tunnel.

Next:
    - When trains are leaving they need to path when the first wagon is out. Maybe use of hidden loco or miroring signals on to underground would help. This should handle wagons or loco's facing backwards being the first carriages out of a tunnel.
    - Handle train stop limits. Breaks trains leaving at present. Use a fake train, change train limits and revert and carefull schedule/manual timed changes.
    - Lock tunnel when its in use by closing both entry signals by using an invisible carriage like the End signal. Remove it when anything is approaching the signal its blocking. If something impacts it then give it 1 health and no kill, wreckage, etc.

Soon:

Later:
    - Handle 2 trains both entering the tunnel at once.
    - Handle very very long trains:
        - Place rails under the underground train carraiges if its a very long train. Maybe defualt 1000 tiles runup is too long and is contributing to lag when making tunnel on large maps (track lag).
        - Confirm that if a train leaving is slowed and it is still entering that the entering train keeps in sync correctly. Should just work.
    - Make recipes, techs and item & entities localisations.
    - Handle trains running out of fuel. Give them enough to get out of the tunnel entirely so the player can deal with.
	- Handle trains being destroyed as they go in/come out of the tunnel.
    - Set entity resistences, health, destroyable.
    - When copying above train to underground handle equipments grids. At present they are lost by the process.
    - Block train wagons being placed on invisible rails.
	- Handle a train leaving a first tunnel and entering a second tunnel. Get by global trainID's tracked.
    - Handle players being in a train going through the tunnel.
    - Handle player driven trains approaching the tunnel (will go on auto through the tunnel).
    - Handle no driver/order trains that "coast" in to the tunnel due to being damaged or whatever. A train that can't power itself in this direction should be hard stopped at the tunnel entrance, otherwise treated like a player driven train.
    - Check artillery trains paused going in to the tunnel as the head has stopped coming out.

NICE TO HAVE:
    - Look at TSM and LTN compatibility requirement or block them.
    - Have a 4x4 tunnel segment that is for 2 tunnels crossing each other. Will need changes to tunnel complete checking logic.
    - Minimap colored lines for tunnels.
    - When you misplace a tunnel part use a render to show the valid spots to the player. As can be annoying to work out which axis is wrong.
    - When a tunnel part is placed invalidly and it is mined by the player/robot it shows the item being picked up. Need to return the item and remove the entity in a silent way. We show red warning text to the player already.
    - Graphics: icons, ingame entities, placement entities.
    - Review what to allow to be built on top of the tunnel segments, either just belts or anything non trains. At present is nothing, but can be driven over.
    - We assume all train carriages are 7 tiles apart, check thier prototypes.
	- When a tunnel is destroyed (by force) there will be a mod setting to drop the train and its contents on the ground at the portal ends. Carraiges, fuel, cargo items, equipment grids.
    - Look at train speed and how long until the train, carraige will next need to be monitored and then have the ongoing function run scheduled for then. This should reduce the event firings from ever second and lower UPS.
    - Very very fast train mods may cause issues as they can move more than 15 tiles per tick, like: https://mods.factorio.com/mod/fast_trans. Either block or force to slow down for tunnels on approach?
	- Tunnel sections shouldn't collide with cliffs, but rail crossing sections should. Also check if cliff reshaping from adjacent cliff removal would destroy tunnels.